"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1742],{607:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>r,default:()=>p,frontMatter:()=>c,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"opis-projektu/pobieranie-danych/scopus-batch","title":"Bramka eksportu Scopus","description":"Modu\u0142 pobieraj\u0105cy dane za pomoc\u0105 bramki eksportu, z kt\xf3rej korzysta interfejs webowy Scopusa.","source":"@site/docs/opis-projektu/pobieranie-danych/scopus-batch.md","sourceDirName":"opis-projektu/pobieranie-danych","slug":"/opis-projektu/pobieranie-danych/scopus-batch","permalink":"/saturday/opis-projektu/pobieranie-danych/scopus-batch","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"Google Scholar","permalink":"/saturday/opis-projektu/pobieranie-danych/google-scholar"},"next":{"title":"Podsumowanie","permalink":"/saturday/podsumowanie"}}');var o=i(4848),s=i(8453);const c={},r="Bramka eksportu Scopus",t={},d=[{value:"Wymagane ciasteczka",id:"wymagane-ciasteczka",level:2},{value:"Punkty ko\u0144cowe",id:"punkty-ko\u0144cowe",level:2},{value:"Wyszukiwanie publikacji po s\u0142owach kluczowych",id:"wyszukiwanie-publikacji-po-s\u0142owach-kluczowych",level:3},{value:"Eksport danych o publikacji",id:"eksport-danych-o-publikacji",level:3},{value:"Od\u015bwie\u017cenie tokenu JWT",id:"od\u015bwie\u017cenie-tokenu-jwt",level:3},{value:"Wst\u0119pne parsowanie CSV",id:"wst\u0119pne-parsowanie-csv",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"bramka-eksportu-scopus",children:"Bramka eksportu Scopus"})}),"\n",(0,o.jsx)(n.p,{children:"Modu\u0142 pobieraj\u0105cy dane za pomoc\u0105 bramki eksportu, z kt\xf3rej korzysta interfejs webowy Scopusa.\nDost\u0119p jest przyznawany na podstawie ciasteczek (sesji) u\u017cytkownika oraz na podstawie \u017ar\xf3d\u0142owego adresu IP."}),"\n",(0,o.jsxs)(n.p,{children:["Modu\u0142 znajduje si\u0119 w katalogu ",(0,o.jsx)(n.a,{href:"https://github.com/bonk-dev/saturday/tree/main/fetcher/scopus_batch",children:"fetcher/scopus_batch"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"wymagane-ciasteczka",children:"Wymagane ciasteczka"}),"\n",(0,o.jsx)(n.p,{children:"Lista wymaganych przez Scopusa ciasteczek:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"AWSELB"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"SCOPUS_JWT"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"SCSessionID"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"scopusSessionUUID"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"punkty-ko\u0144cowe",children:"Punkty ko\u0144cowe"}),"\n",(0,o.jsx)(n.p,{children:"Nie istnieje publiczna dokumentacja punkt\xf3w ko\u0144cowych bramki eksportu. To, w jaki spos\xf3b interfejs webowy Scopusa korzysta\nz tej bramki, zosta\u0142o wydedukowane na podstawie analizy ruchu sieciowego."}),"\n",(0,o.jsx)(n.h3,{id:"wyszukiwanie-publikacji-po-s\u0142owach-kluczowych",children:"Wyszukiwanie publikacji po s\u0142owach kluczowych"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-http",metastring:'request title="\u017b\u0105danie zwracaj\u0105ce odpowied\u017a z list\u0105 identyfikator\xf3w znalezionych publikacji. Format cia\u0142a \u017c\u0105dania: JSON"',children:'POST https://www.scopus.com/api/documents/search/eids\n{\n    "documentClassificationEnum": "primary",\n    "itemcount": 5,\n    "offset": 0,\n    "query": "TITLE-ABS-KEY(python)",\n    "sort": \'plf-f\'\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Maksymalna liczba identyfikator\xf3w zwr\xf3conych w jednej odpowiedzi (parametr ",(0,o.jsx)(n.code,{children:"itemcount"}),") to ",(0,o.jsx)(n.code,{children:"2000"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"Przyk\u0142adowa odpowied\u017a:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",metastring:'title="Odpowied\u017a na POST /api/documents/search/eids"',children:'"response": {\n    "numFound": 1455,\n    "docs": [\n        "2-s2.0-85216271415",\n        "2-s2.0-105003577803",\n        "2-s2.0-105003654530",\n        "2-s2.0-105003921873",\n        "2-s2.0-105003970001"\n    ]\n}\n'})}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"numFound"})," zwraca liczb\u0119 wszystkich znalezionych w bazie publikacji, a nie liczb\u0119 zwr\xf3conych wynik\xf3w."]})}),"\n",(0,o.jsx)(n.h3,{id:"eksport-danych-o-publikacji",children:"Eksport danych o publikacji"}),"\n",(0,o.jsx)(n.p,{children:"Za pomoc\u0105 bramki mo\u017cna wyeksportowa\u0107 dane o maksymalnie stu publikacjach na jedno \u017c\u0105danie. Obs\u0142ugiwane formaty to:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"CSV"}),"\n",(0,o.jsx)(n.li,{children:"RIS"}),"\n",(0,o.jsx)(n.li,{children:"BibTex"}),"\n",(0,o.jsx)(n.li,{children:"tekst."}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"W eksporcie do CSV znajduje si\u0119 najwi\u0119cej informacji, dlatego w\u0142a\u015bnie ten format jest wykorzystywany przez program."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-http",metastring:'request title="\u017b\u0105danie zwracaj\u0105ce dane o publikacjach. Format cia\u0142a \u017c\u0105dania: JSON"',children:'POST https://www.scopus.com/gateway/export-service/export?batch_id=aaaaaa_0_0\n{\n    "eids": [\n        "2-s2.0-85216271415",\n        "2-s2.0-105003577803",\n        "2-s2.0-105003654530",\n        "2-s2.0-105003921873",\n        "2-s2.0-105003970001"\n    ],\n    "fileType": "CSV",\n    "fieldGroupIdentifiers": ["titles", "authors", "doi", "..."],\n    "keyEvent": {\n        "sessionId": "SC_SESSION_ID cookie value",\n        "transactionId": "SC_SESSION_ID:1"\n        "origin": "resultsList",\n        "zone": "resultsListHeader",\n        "primary": "",\n        "totalDocs": 1455\n    },\n    "locale": "en-US",\n    "hideHeaders": false\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Parametry:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"eids"})," - lista identyfikator\xf3w EID publikacji"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"fileType"})," - format eksportu"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"fieldGroupIdentifiers"})," - lista p\xf3l, kt\xf3re maj\u0105 si\u0119 pojawi\u0107 w pliku CSV"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"keyEvent"})," - obiekt opisuj\u0105cy zdarzenie w interfejsie webowym; nie ma wp\u0142ywu na eksport"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"locale"})," - j\u0119zyk"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"hideHeaders"})," - w pliku CSV: je\u017celi ",(0,o.jsx)(n.code,{children:"false"}),", pojawi si\u0119 wiersz nag\u0142\xf3wkowy Title, Authors, DOI itd. Je\u017celi ",(0,o.jsx)(n.code,{children:"true"}),",\nten wiersz nie zostanie dodany."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"od\u015bwie\u017cenie-tokenu-jwt",children:"Od\u015bwie\u017cenie tokenu JWT"}),"\n",(0,o.jsxs)(n.p,{children:["Do komunikacji z bramk\u0105 potrzebny jest m.in. token JWT, kt\xf3ry jest wysy\u0142any jako ciasteczko (w nag\u0142\xf3wku ",(0,o.jsx)(n.code,{children:"Cookie"}),")\no nazwie ",(0,o.jsx)(n.code,{children:"SCOPUS_JWT"}),". Jest on wa\u017cny przez oko\u0142o 15/20 minut. Po up\u0142ywie tego czasu (mierzonego od utworzenia tokenu)\nnale\u017cy go od\u015bwie\u017cy\u0107 za pomoc\u0105 poni\u017cszego \u017c\u0105dania."]}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsx)(n.p,{children:"Aplikacja nie sprawdza wa\u017cno\u015bci tokenu. Token jest od\u015bwie\u017cany, gdy kt\xf3re\u015b \u017c\u0105danie zwr\xf3ci odpowied\u017a o kodzie statusu 403."})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-http",metastring:'request title="\u017b\u0105danie od\u015bwie\u017caj\u0105ce token JWT"',children:"GET https://www.scopus.com/api/auth/refresh-scopus-jwt\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Po pomy\u015blnym od\u015bwie\u017ceniu serwer zwr\xf3ci odpowied\u017a o kodzie 200, z nag\u0142\xf3wkiem ",(0,o.jsx)(n.code,{children:"Set-Cookie"})," zawieraj\u0105cym nowy token.\nJe\u017celi od\u015bwie\u017cenie nie powiod\u0142o si\u0119, serwer zwr\xf3ci odpowied\u017a z przekierowaniem (kod 3xx)."]}),"\n",(0,o.jsx)(n.h2,{id:"wst\u0119pne-parsowanie-csv",children:"Wst\u0119pne parsowanie CSV"}),"\n",(0,o.jsxs)(n.p,{children:["Po wyeksportowaniu danych modu\u0142 parsuje plik CSV za pomoc\u0105 wbudowanego modu\u0142u ",(0,o.jsx)(n.code,{children:"csv"}),". Logika odpowiedzialna za parsowanie\nznajduje si\u0119 w pliku\n",(0,o.jsx)(n.a,{href:"https://github.com/bonk-dev/saturday/tree/main/fetcher/scopus_batch/parser.py",children:"fetcher/scopus_batch/parser.py"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"Parser oczekuje ca\u0142ego, kompletnego pliku. Wywo\u0142a on b\u0142\u0105d, gdy wiersz nag\u0142\xf3wkowy nie b\u0119dzie si\u0119 zgadza\u0142 z oczekiwanym."})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);