"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1819],{8942:(s,e,a)=>{a.r(e),a.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>t,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"opis-projektu/pobieranie-danych/google-scholar","title":"Google Scholar","description":"Modu\u0142 pobierania danych znajduje si\u0119","source":"@site/docs/opis-projektu/pobieranie-danych/google-scholar.md","sourceDirName":"opis-projektu/pobieranie-danych","slug":"/opis-projektu/pobieranie-danych/google-scholar","permalink":"/saturday/opis-projektu/pobieranie-danych/google-scholar","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"API Elsevier (Scopus)","permalink":"/saturday/opis-projektu/pobieranie-danych/elsevier-api"},"next":{"title":"Bramka eksportu Scopus","permalink":"/saturday/opis-projektu/pobieranie-danych/scopus-batch"}}');var i=a(4848),o=a(8453);const t={},r="Google Scholar",c={},l=[{value:"Przygotowanie sesji",id:"przygotowanie-sesji",level:2},{value:"Scrapowanie HTML",id:"scrapowanie-html",level:2},{value:"Pobieranie i parsowanie BibTex",id:"pobieranie-i-parsowanie-bibtex",level:2}];function d(s){const e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...s.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"google-scholar",children:"Google Scholar"})}),"\n",(0,i.jsxs)(e.p,{children:["Modu\u0142 pobierania danych znajduje si\u0119\nw ",(0,i.jsx)(e.a,{href:"https://github.com/bonk-dev/saturday/tree/main/fetcher/gscholar",children:"fetcher/gscholar"}),"."]}),"\n",(0,i.jsx)(e.p,{children:"Pozyskiwanie informacji o publikacjach opiera si\u0119 na me scrapingu stron HTML oraz pobieraniu plik\xf3w w formacie bibtex."}),"\n",(0,i.jsx)(e.h2,{id:"przygotowanie-sesji",children:"Przygotowanie sesji"}),"\n",(0,i.jsx)(e.p,{children:"Przed rozpocz\u0119ciem pozyskiwania danych, klient w\u0142\u0105cza wy\u015bwietlanie link\xf3w do plik\xf3w cytowania w formacie bibtex.\nPozwala to na zaoszcz\u0119dzenie jednego \u017c\u0105dania na ka\u017cd\u0105 pozycj\u0119 na pojedynczej stronie wyszukiwania."}),"\n",(0,i.jsx)(e.p,{children:"Na pocz\u0105tek wysy\u0142ane jest \u017c\u0105danie o stron\u0119 ustawie\u0144, z kt\xf3rej odczytywane s\u0105 potrzebne parametry:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-http",metastring:'request title="Strona ustawie\u0144/preferencji"',children:"GET https://scholar.google.com/scholar_settings?hl=en&as_sdt=0,5\n"})}),"\n",(0,i.jsx)(e.p,{children:"Odczytywanie parametr\xf3w:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"s = BeautifulSoup(settings_page_r.text, 'html.parser')\nform_e = s.find('form', attrs={'id': 'gs_bdy_frm'})\nscisig_e = form_e.find('input', attrs={'name': 'scisig'})\nscisig = scisig_e.attrs['value']\n\ninst_e = (s\n          .find('div', attrs={'id': 'gs_settings_liblinks_lst'})\n          .find('input', attrs={'name': 'inst'}))\ninst_val = inst_e.attrs['value']\n"})}),"\n",(0,i.jsxs)(e.p,{children:["Nast\u0119pnie wysy\u0142ane jest \u017c\u0105danie POST do ",(0,i.jsx)(e.code,{children:"/scholar_setprefs"}),", z warto\u015bci\u0105 parametru ",(0,i.jsx)(e.code,{children:"scis"})," ustawion\u0105 na ",(0,i.jsx)(e.code,{children:"yes"}),", co w\u0142\u0105cza\nwy\u015bwietlanie link\xf3w do plik\xf3w bibtex:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-http",metastring:'request title="Wysy\u0142anie nowych ustawie\u0144"',children:"POST https://scholar.google.com/scholar_setprefs?scis=yes&[...]\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"await self._session.get(f'{self._base}/scholar_setprefs', params={\n            'scisig': scisig,\n            'xsrf': '',\n            'as_sdt': '0,5',\n            'scis': 'yes',  # add BibTex citation links\n            'scisf': '4',\n            'hl': 'en',\n            'lang': 'all',\n            'instq': '',\n            'inst': inst_val,\n            'boi_access': '1',\n            'has_boo_access': '1',\n            'has_casa_opt_in': '1',\n            'save': ''\n        })\n"})}),"\n",(0,i.jsx)(e.h2,{id:"scrapowanie-html",children:"Scrapowanie HTML"}),"\n",(0,i.jsx)(e.p,{children:"Wyszukiwarka zwraca po dziesi\u0119\u0107 pozycji na stron\u0119. Ka\u017cda strona ma niezmienn\u0105 struktur\u0119 HTML, co u\u0142atwia pobieranie\ndanych. Klient wysy\u0142a nast\u0119puj\u0105ce \u017c\u0105danie, aby pobra\u0107 dan\u0105 stron\u0119:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-http",metastring:'request title="Pobieranie pojedynczej strony z wynikami wyszukiwania"',children:"GET https://scholar.google.com/scholar?start=0&q=python3&hl=en&as_sdt=0,5&as_vis=1\n"})}),"\n",(0,i.jsx)(e.p,{children:"Gdzie:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"start"})," oznacza pozycj\u0119, od kt\xf3rej ma zaczyna\u0107 si\u0119 strona;"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"q"})," to wyszukiwana fraza;"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"hl"})," to j\u0119zyk;"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"as_vis"}),' ustawione na jeden wyklucza pozycje "cytat".']}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["Na pocz\u0105tku klient sprawdza, czy w kodzie strony znajduje si\u0119 formularz o id = ",(0,i.jsx)(e.code,{children:"gs_captcha_f"}),". Je\u017celi tak, to Google\nwykry\u0142o naszego klienta jako bota. W takim momencie klient zmienia serwer po\u015brednicz\u0105cy na nast\u0119pny z listy. Je\u017celi nie\nma pozosta\u0142ych, nieu\u017cytych wcze\u015bniej serwer\xf3w to klient ko\u0144czy prac\u0119."]}),"\n",(0,i.jsxs)(e.p,{children:["Ka\u017cda pozycja na stronie zawiera si\u0119 w elemencie, kt\xf3rego atrybut klasy jest ustawiony na ",(0,i.jsx)(e.code,{children:"gs_r gs_or gs_scl"}),"."]}),"\n",(0,i.jsx)(e.p,{children:"Przyk\u0142adowa pozycja:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",children:'<div class="gs_r gs_or gs_scl" data-cid="QhDl7b8ZhqwJ" data-did="QhDl7b8ZhqwJ" data-lid="" data-aid="QhDl7b8ZhqwJ"\n     data-rp="0">\n    <div class="gs_ri"><h3 class="gs_rt" ontouchstart="gs_evt_dsp(event)"><span class="gs_ctc"><span class="gs_ct1">[PDF]</span><span\n            class="gs_ct2">[PDF]</span></span> <a id="QhDl7b8ZhqwJ"\n                                                  href="http://static.softwaresuggest.com.s3.amazonaws.com/ssguides/1604480172_Python_read%20(1).pdf"\n                                                  data-clk="hl=en&amp;sa=T&amp;oi=ggp&amp;ct=res&amp;cd=0&amp;d=12431652133523492930&amp;ei=VGlDaJqQHZLXieoPwNDK0Qk"\n                                                  data-clk-atid="QhDl7b8ZhqwJ"><b>Python</b></a></h3>\n        <div class="gs_a">W <b>Python</b>&nbsp;- <b>Python </b>releases for windows, 2021 -\n            static.softwaresuggest.com.s3&nbsp;\u2026\n        </div>\n        <div class="gs_rs">\u2022 <b>Python</b> was designed for readability, and has some similarities to the English\n            language with <br>\n            influence from mathematics.\u2022 <b>Python</b> uses new lines to complete a command, as opposed \u2026\n        </div>\n        <div class="gs_fl gs_flb"><a href="javascript:void(0)" class="gs_or_sav gs_or_btn" role="button">\n            <svg viewBox="0 0 15 16" class="gs_or_svg">\n                <path d="M7.5 11.57l3.824 2.308-1.015-4.35 3.379-2.926-4.45-.378L7.5 2.122 5.761 6.224l-4.449.378 3.379 2.926-1.015 4.35z"></path>\n            </svg>\n            <span class="gs_or_btn_lbl">Save</span></a> <a href="javascript:void(0)" class="gs_or_cit gs_or_btn gs_nph"\n                                                           role="button" aria-controls="gs_cit" aria-haspopup="true">\n            <svg viewBox="0 0 15 16" class="gs_or_svg">\n                <path d="M6.5 3.5H1.5V8.5H3.75L1.75 12.5H4.75L6.5 9V3.5zM13.5 3.5H8.5V8.5H10.75L8.75 12.5H11.75L13.5 9V3.5z"></path>\n            </svg>\n            <span>Cite</span></a> <a\n                href="/scholar?cites=12431652133523492930&amp;as_sdt=2005&amp;sciodt=0,5&amp;hl=en">Cited by 119</a> <a\n                href="/scholar?q=related:QhDl7b8ZhqwJ:scholar.google.com/&amp;scioq=python&amp;hl=en&amp;as_sdt=0,5">Related\n            articles</a> <a href="/scholar?cluster=12431652133523492930&amp;hl=en&amp;as_sdt=0,5" class="gs_nph">All 30\n            versions</a> <a\n                href="https://scholar.googleusercontent.com/scholar.bib?q=info:QhDl7b8ZhqwJ:scholar.google.com/&amp;output=citation&amp;scisdr=CgL8tDnCEMTS5YFttKQ:AAZF9b8AAAAAaENrrKRxlAx44kBSs0GnuPx1YsE&amp;scisig=AAZF9b8AAAAAaENrrIUEmQ9R2G61TAmYH0-fnQE&amp;scisf=4&amp;ct=citation&amp;cd=0&amp;hl=en"\n                class="gs_nta gs_nph">Import into BibTeX</a> \n            <a href="javascript:void(0)" title="More" class="gs_or_mor" role="button">\n                <svg viewBox="0 0 15 16" class="gs_or_svg">\n                    <path d="M0.75 5.5l2-2L7.25 8l-4.5 4.5-2-2L3.25 8zM7.75 5.5l2-2L14.25 8l-4.5 4.5-2-2L10.25 8z"></path>\n                </svg>\n            </a>\n        </div>\n    </div>\n</div>\n'})}),"\n",(0,i.jsx)(e.p,{children:"Odczytywane warto\u015bci (opisane selektorami CSS):"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:".gs_rt a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:".text: tytu\u0142 publikacji"}),"\n",(0,i.jsx)(e.li,{children:".href: link do publikacji"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:".gs_ctc"}),": typ pliku"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:".gs_a"}),": autorzy"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"a.gs_nta.gs_nph"}),' (tekst musi by\u0107 r\xf3wny: "Import into BibTeX"): link do pliku bibtex']}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"pobieranie-i-parsowanie-bibtex",children:"Pobieranie i parsowanie BibTex"}),"\n",(0,i.jsx)(e.p,{children:"Dane pobrane ze stron HTML s\u0105 niedok\u0142adne (skr\xf3cone do okre\u015blonych d\u0142ugo\u015bci). Program pobiera dane BibTex z wcze\u015bniej\nzescrapowanych link\xf3w i na ich podstawie uzupe\u0142nia dane. Wysy\u0142ane \u017c\u0105danie na ka\u017cd\u0105 pozycj\u0119:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-http",metastring:'request title="Pobieranie pliku BibTex dla pojedynczej pozycji"',children:"GET https://scholar.googleusercontent.com/scholar.bib?q=info:QhDl7b8ZhqwJ:scholar.google.com/&output=citation&scisdr=CgL8tDnCEMTS5YFttKQ:AAZF9b8AAAAAaENrrKRxlAx44kBSs0GnuPx1YsE&scisig=AAZF9b8AAAAAaENrrIUEmQ9R2G61TAmYH0-fnQE&scisf=4&ct=citation&cd=0&hl=en\n"})}),"\n",(0,i.jsxs)(e.p,{children:["Do parsowania pliku program wykorzystuje bibliotek\u0119 ",(0,i.jsx)(e.a,{href:"https://github.com/sciunto-org/python-bibtexparser",children:"bibtexparser"}),"."]})]})}function p(s={}){const{wrapper:e}={...(0,o.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(d,{...s})}):d(s)}}}]);